<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>CIVINET Incident Feed</title>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
      href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
      rel="stylesheet"
    />
    <link href="styles.css" rel="stylesheet" />
    <link href="components.css" rel="stylesheet" />
    <script src="app.js" defer></script>
    <script src="components.js" defer></script>
    <style>
      /* Instagram-like feed enhancements */
      .card {
        animation: fadeInUp 0.4s ease;
        margin-bottom: 1.5rem;
      }
      
      .card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
      }
      
      .card-image {
        cursor: pointer;
        transition: all 0.3s ease;
      }
      
      .card-image:active {
        transform: scale(0.98);
      }
      
      .action-btn {
        transition: all 0.2s ease;
      }
      
      .action-btn:hover {
        background: rgba(19, 127, 236, 0.1);
        color: var(--primary);
      }
      
      .action-btn:active {
        transform: scale(0.95);
      }
      
      .action-btn.liked {
        color: var(--primary);
        font-weight: 700;
      }
      
      .action-btn.liked .material-symbols-outlined {
        font-variation-settings: 'FILL' 1;
      }
      
      .action-btn.disliked {
        color: #ef4444;
        font-weight: 700;
      }
      
      .action-btn.disliked .material-symbols-outlined {
        font-variation-settings: 'FILL' 1;
      }
      
      .action-btn.saved {
        color: #22c55e;
        font-weight: 700;
      }
      
      .action-btn.saved .material-symbols-outlined {
        font-variation-settings: 'FILL' 1;
      }
      
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
      @keyframes heartBeat {
        0%, 100% {
          transform: scale(1);
        }
        25% {
          transform: scale(1.3);
        }
        50% {
          transform: scale(1.1);
        }
        75% {
          transform: scale(1.2);
        }
      }
      
      .heart-animation {
        animation: heartBeat 0.6s ease;
      }
    </style>
  </head>
  <body>
    <div class="container has-bottom-nav">
      <header class="header-sticky">
        <div class="p-4 space-y-4">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-2">
              <span class="material-symbols-outlined text-primary text-2xl">location_on</span>
              <h1 class="text-lg font-bold location-display">San Francisco</h1>
            </div>
            <div class="flex items-center gap-2">
              <a href="./LeaderBord.html" class="p-2">
                <span class="material-symbols-outlined text-secondary text-2xl">leaderboard</span>
              </a>
              <button class="relative p-2">
                <span class="material-symbols-outlined text-secondary text-2xl">notifications</span>
                <span class="notification-dot">
                  <span class="notification-dot-ping"></span>
                  <span class="notification-dot-static"></span>
                </span>
              </button>
            </div>
          </div>
          <div class="relative">
            <label class="sr-only" for="search-incidents">Search incidents</label>
            <span class="search-icon">
              <span class="material-symbols-outlined">search</span>
            </span>
            <input
              class="search-input"
              id="search-incidents"
              placeholder="Search incidents..."
              type="search"
            />
          </div>
        </div>
      </header>
      
      <main class="flex-grow p-4 space-y-6" style="padding-bottom: 6rem;">
        <div class="card">
          <div class="flex items-start justify-between p-3 gap-3">
            <div class="flex items-center gap-3">
              <img
                alt="Alex Chen's profile picture"
                class="profile-image"
                src="https://lh3.googleusercontent.com/aida-public/AB6AXuBVnoYtKuGcnCgC8PXylAc-GOBGYWg2lzL4ZFIZv0QVtRWOnSOFFi_tpoiT4OjCN1Vrmgb4Q3J3JPzwbzitmAGtd60KjlLoMii-_aCHLfx3Dy8Rx1BEsv7NI8Z9C77t50SF8cEK50yyuNhGsukyZS3XbuQN6MpPltPB9oBXbWkEPTDuD617zGWHJ1VhvsofUSuTCcIpOMG8UaoFAIo9AD4pzn_VXsBoT7_9Bxfonzzjdfhnlhh8hwQ1KsDyfsAC8g4LE_t1wbbzJQ"
              />
              <div>
                <p class="font-bold text-sm">Alex Chen</p>
                <p class="text-xs text-secondary">2 days ago</p>
              </div>
            </div>
            <button class="report-btn">
              <span class="material-symbols-outlined text-base">flag</span>
              Report
            </button>
          </div>
          <img
            alt="A large pothole on a residential street."
            class="card-image"
            src="https://lh3.googleusercontent.com/aida-public/AB6AXuA5WL8lkWbdhhOiS8GhmLv02f2bpXbFyjNUeGJ0wKlAya3_icRxru-HzUWT_aoss73vO3-PDlYCQlfQL0iiX6gES_UXnpwopMF3UeLYgT4M-hkBBH-XNzCpYS5hcMkBIF0pA_6H7Fmc657fetluCMezqRfQMFqa6mO1cSCOr3ETyo13CIc637_R6JrerFBpoFhnNnGwML5iqThD-km0GL4jtqFtSo2FQF3XYvr6dgsu-jETb2wVtoy3BKiHy-WFKHZRZ8vhyURaHg"
          />
          <div class="p-4">
            <h2 class="text-lg font-bold mb-1">Pothole on Main Street</h2>
            <p class="text-sm text-secondary mb-3">
              A large and dangerous pothole has formed on Main Street near the
              intersection with Oak Avenue.
            </p>
            <div class="flex items-center text-sm text-secondary">
              <span class="material-symbols-outlined text-base mr-1">location_pin</span>
              <span>Main Street, San Francisco</span>
            </div>
          </div>
          <div class="flex justify-around border-t border-light py-1">
            <button class="action-btn like-btn" data-likes="12">
              <span class="material-symbols-outlined text-xl">thumb_up</span>
              <span class="text-sm font-medium like-count">12</span>
            </button>
            <button class="action-btn dislike-btn" data-dislikes="2">
              <span class="material-symbols-outlined text-xl">thumb_down</span>
              <span class="text-sm font-medium dislike-count">2</span>
            </button>
            <button class="action-btn share-btn">
              <span class="material-symbols-outlined text-xl">share</span>
              <span class="text-sm font-medium">Share</span>
            </button>
            <button class="action-btn save-btn">
              <span class="material-symbols-outlined text-xl">bookmark</span>
              <span class="text-sm font-medium">Save</span>
            </button>
          </div>
        </div>
        
        <div class="card">
          <div class="flex items-start justify-between p-3 gap-3">
            <div class="flex items-center gap-3">
              <img
                alt="Maya Patel's profile picture"
                class="profile-image"
                src="https://lh3.googleusercontent.com/aida-public/AB6AXuADV79WTopKmM0LiAeDLNGXzKB-VK-6Zx3pI8gxfY23bDDfurLu2bF5jLc4-TFMZYe9vBCsc7lrc2lT1O8dyVKSvO1eSX59wMNcq06wgNClJdaumDw8ACyFhbuB6UJSnqgpP82cMau66KT3lwDPwkg7hE5Tg5CuXANwkOE-aoXn5-dbxjbeV2SUkpdOKswuLhB50myF3RDHjFLtMRHyYqN-q5uzJYjyAjiHcvgLtysWj1qkPBsd_UW31O6mWIt0yAmvt3x9ZseE4A"
              />
              <div>
                <p class="font-bold text-sm">Maya Patel</p>
                <p class="text-xs text-secondary">1 day ago</p>
              </div>
            </div>
            <button class="report-btn">
              <span class="material-symbols-outlined text-base">flag</span>
              Report
            </button>
          </div>
          <img
            alt="Graffiti on a brick building wall."
            class="card-image"
            src="https://lh3.googleusercontent.com/aida-public/AB6AXuAfvvYT6h115b_smaVpnZNVsOx4YqH02D_ymlmvNZMVX6c02u5eY80Qc6DcvQaKtms7lyYGFAwUSzdNV0RXpg82R_yNOA8NsTfx_8C9EzxWIN5UMlBvhj74XysMfeaJhv86RhWJbg45801IVPj3ivfCoioC3XfQQqVNScMuKOokJrLaDaSxbySZqPgseziWbuJz0C-99JiHpP1AjThcRzqRkM1fG8TvL4vqshTLTY7wPS7SPuYF7wThpqWlhUN4gFWN-N8w97-y8Q"
          />
          <div class="p-4">
            <h2 class="text-lg font-bold mb-1">Graffiti on Building</h2>
            <p class="text-sm text-secondary mb-3">
              Extensive graffiti covering the side of the public library building.
            </p>
            <div class="flex items-center text-sm text-secondary">
              <span class="material-symbols-outlined text-base mr-1">location_pin</span>
              <span>Civic Center Plaza</span>
            </div>
          </div>
          <div class="flex justify-around border-t border-light py-1">
            <button class="action-btn like-btn" data-likes="8">
              <span class="material-symbols-outlined text-xl">thumb_up</span>
              <span class="text-sm font-medium like-count">8</span>
            </button>
            <button class="action-btn dislike-btn" data-dislikes="1">
              <span class="material-symbols-outlined text-xl">thumb_down</span>
              <span class="text-sm font-medium dislike-count">1</span>
            </button>
            <button class="action-btn share-btn">
              <span class="material-symbols-outlined text-xl">share</span>
              <span class="text-sm font-medium">Share</span>
            </button>
            <button class="action-btn save-btn">
              <span class="material-symbols-outlined text-xl">bookmark</span>
              <span class="text-sm font-medium">Save</span>
            </button>
          </div>
        </div>
      </main>
      
      <footer class="nav-footer">
        <nav class="nav-container">
          <a class="nav-link active" href="#">
            <span class="material-symbols-outlined" style="font-variation-settings: 'FILL' 1">home</span>
            <span class="text-xs font-bold">Home</span>
          </a>
          <a class="nav-link" href="./ReportIncident.html">
            <span class="material-symbols-outlined">photo_camera</span>
            <span class="text-xs font-medium">Camera</span>
          </a>
          <a class="nav-link" href="./showALLReport.html">
            <span class="material-symbols-outlined">edit_document</span>
            <span class="text-xs font-medium">Report</span>
          </a>
          <a class="nav-link" href="./profile.html">
            <span class="material-symbols-outlined">person</span>
            <span class="text-xs font-medium">Profile</span>
          </a>
        </nav>
      </footer>
    </div>
    
    <script>
      // Enhanced Like/Dislike interactions
      document.addEventListener('DOMContentLoaded', () => {
        // Initialize location on page load
        if (typeof userLocation !== 'undefined' && userLocation.city) {
          document.querySelectorAll('.location-display').forEach(el => {
            el.textContent = userLocation.city;
          });
        } else {
          // Auto-detect location
          detectLocation((location) => {
            document.querySelectorAll('.location-display').forEach(el => {
              el.textContent = location.city;
            });
          }, (error) => {
            console.log('Location detection failed:', error);
          });
        }
        
        // Like button functionality
        document.querySelectorAll('.like-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const card = this.closest('.card');
            const dislikeBtn = card.querySelector('.dislike-btn');
            const likeCount = this.querySelector('.like-count');
            const dislikeCount = dislikeBtn.querySelector('.dislike-count');
            const icon = this.querySelector('.material-symbols-outlined');
            
            let likes = parseInt(likeCount.textContent);
            let dislikes = parseInt(dislikeCount.textContent);
            
            // If already liked, remove like
            if (this.classList.contains('liked')) {
              this.classList.remove('liked');
              likeCount.textContent = likes - 1;
              showNotification('Like removed', 'info');
            } else {
              // If disliked, remove dislike first
              if (dislikeBtn.classList.contains('disliked')) {
                dislikeBtn.classList.remove('disliked');
                dislikeCount.textContent = dislikes - 1;
              }
              
              // Add like
              this.classList.add('liked');
              likeCount.textContent = likes + 1;
              icon.classList.add('heart-animation');
              showNotification('Post liked!', 'success');
              
              setTimeout(() => icon.classList.remove('heart-animation'), 600);
            }
          });
        });
        
        // Dislike button functionality
        document.querySelectorAll('.dislike-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const card = this.closest('.card');
            const likeBtn = card.querySelector('.like-btn');
            const dislikeCount = this.querySelector('.dislike-count');
            const likeCount = likeBtn.querySelector('.like-count');
            const icon = this.querySelector('.material-symbols-outlined');
            
            let dislikes = parseInt(dislikeCount.textContent);
            let likes = parseInt(likeCount.textContent);
            
            // If already disliked, remove dislike
            if (this.classList.contains('disliked')) {
              this.classList.remove('disliked');
              dislikeCount.textContent = dislikes - 1;
              showNotification('Dislike removed', 'info');
            } else {
              // If liked, remove like first
              if (likeBtn.classList.contains('liked')) {
                likeBtn.classList.remove('liked');
                likeCount.textContent = likes - 1;
              }
              
              // Add dislike
              this.classList.add('disliked');
              dislikeCount.textContent = dislikes + 1;
              icon.classList.add('heart-animation');
              showNotification('Post disliked', 'info');
              
              setTimeout(() => icon.classList.remove('heart-animation'), 600);
            }
          });
        });
        
        // Save button functionality
        document.querySelectorAll('.save-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            if (this.classList.contains('saved')) {
              this.classList.remove('saved');
              showNotification('Removed from saved', 'info');
            } else {
              this.classList.add('saved');
              showNotification('Post saved!', 'success');
            }
          });
        });
        
        // Share button functionality
        document.querySelectorAll('.share-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            showNotification('Share feature coming soon!', 'info');
          });
        });
        
        // Double-tap to like (mobile)
        document.querySelectorAll('.card-image').forEach(img => {
          let lastTap = 0;
          
          img.addEventListener('click', function() {
            const currentTime = new Date().getTime();
            const tapGap = currentTime - lastTap;
            
            if (tapGap < 300 && tapGap > 0) {
              // Double tap detected
              const card = this.closest('.card');
              const likeBtn = card.querySelector('.like-btn');
              
              if (!likeBtn.classList.contains('liked')) {
                likeBtn.click();
                
                // Show heart animation overlay
                const heart = document.createElement('div');
                heart.innerHTML = '<span class="material-symbols-outlined" style="font-size: 5rem; color: var(--primary);">thumb_up</span>';
                heart.style.cssText = 'position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 10; animation: heartBeat 0.6s ease; pointer-events: none; opacity: 0.9;';
                
                this.parentElement.style.position = 'relative';
                this.parentElement.appendChild(heart);
                
                setTimeout(() => heart.remove(), 600);
              }
            }
            
            lastTap = currentTime;
          });
        });
      });
    </script>
  </body>
</html>
